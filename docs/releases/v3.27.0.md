# GenoMAX² API v3.27.0 Release Notes

**Release Date:** January 17, 2026

## Summary

Launch v1 enforcement is now complete. All external pipelines (Design Export, Shopify) enforce the hard guardrail: `is_launch_v1 = TRUE AND supplier_status = 'ACTIVE'`. No TIER 3 products will reach external systems.

## New Endpoints

### Pairing QA
```
GET /api/v1/qa/launch-v1/pairing
```
Validates that every base product exists exactly twice (MAXimo² + MAXima²). Returns PASS/FAIL with offender list.

**Response Example:**
```json
{
  "overall_status": "PASS",
  "scope": {"is_launch_v1": true, "supplier_status": "ACTIVE"},
  "distribution": [{"env_count": 2, "base_products": 94}],
  "total_base_products": 94,
  "total_modules": 188,
  "maximo_count": 94,
  "maxima_count": 94,
  "offenders": [],
  "invariants": {
    "modules_equals_maximo_plus_maxima": true,
    "pairs_complete_if_pass": true
  }
}
```

### Design Export
```
GET /api/v1/launch-v1/export/design
```
Excel export with:
- **LAUNCH_V1_SUMMARY** tab: modules_count, base_products_count, tier breakdown, invariant checks
- **READY_FOR_DESIGN** tab: All Launch v1 products with base_handle column
- **PAIRING_OFFENDERS** tab: (if any) Products missing their environment pair

### Launch v1 Products List
```
GET /api/v1/launch-v1/products?environment=MAXimo²&tier=TIER%201&limit=100
```
Lists all Launch v1 products with derived `base_handle`.

### Launch v1 Summary
```
GET /api/v1/launch-v1/summary
```
Quick dashboard summary without full product list.

## Shopify Enforcement

All Shopify endpoints now filter by Launch v1 scope:

| Endpoint | Change |
|----------|--------|
| `GET /api/v1/shopify/readiness/summary` | Added Launch v1 scope filter |
| `POST /api/v1/shopify/export/dry-run` | Added Launch v1 scope filter |
| `POST /api/v1/shopify/export/publish` | Added Launch v1 scope filter |

**Hard Guardrail Applied:**
```sql
WHERE is_launch_v1 = TRUE AND supplier_status = 'ACTIVE'
```

## New Fields

### BlockedReason Enum
Added `NOT_LAUNCH_V1` reason for modules not in Launch v1 scope.

### Response Payloads
- Added `tier` field to all product responses
- Added `base_handle` derived from `shopify_handle`
- Added `scope` object to all export responses

## Summary Tab Fields

The LAUNCH_V1_SUMMARY Excel tab includes:

| Field | Description |
|-------|-------------|
| `modules_count` | Total rows exported |
| `base_products_count` | Unique base_handle count |
| `maximo_rows` | MAXimo² environment count |
| `maxima_rows` | MAXima² environment count |
| `tier_1_count` | TIER 1 modules |
| `tier_2_count` | TIER 2 modules |
| `modules_count = maximo + maxima` | PASS/FAIL invariant |
| `Pairing Complete` | PASS/FAIL (all pairs = 2) |

## Verification Commands

After deployment, verify with:

```bash
# 1. Pairing QA (must return PASS)
curl -sS https://web-production-97b74.up.railway.app/api/v1/qa/launch-v1/pairing | jq '.overall_status'

# 2. Launch v1 scope QA (must return passed: true)
curl -sS https://web-production-97b74.up.railway.app/qa/launch-v1-scope | jq '.passed'

# 3. Design Export (download and verify LAUNCH_V1_SUMMARY tab)
curl -O https://web-production-97b74.up.railway.app/api/v1/launch-v1/export/design

# 4. Shopify readiness (verify scope filter applied)
curl -sS https://web-production-97b74.up.railway.app/api/v1/shopify/readiness/summary | jq '.scope'
```

## Brain Logic (Unchanged)

Brain logic and research views remain **unfiltered** and can access all tiers for algorithm development and research purposes.

## Files Changed

| File | Change |
|------|--------|
| `app/launch/enforcement.py` | NEW: Launch v1 enforcement router |
| `app/launch/__init__.py` | Export enforcement_router |
| `app/integrations/shopify_router.py` | Add Launch v1 filter to all exports |
| `main.py` | Register enforcement router, bump to v3.27.0 |

## Migration Status

No new migrations required. Uses existing:
- `tier` column (Migration 009a)
- `is_launch_v1` column (Migration 009b)
